function p=normalcdf(z)
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% Introduction
%     linear interpolation for calculation of normcdf
% Input
%    z(vector) value  
% 
% Output
%    p probablility
% 
%   Implemented by
%      JD.Wang 2019.5.28
% 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
z(z==inf)=5;
z(z==-inf)=-5;
p=(z>4);
p0=[3.16712418331200e-05,4.42744843120707e-05,6.15171551832554e-05,8.49566784979981e-05,0.000116616976815368,0.000159108590157534,0.000215773399294717,0.000290857093290744,0.000389712362582033,0.000519035433206972,0.000687137937915849,0.000904255199822341,0.00118289074310441,0.00153819521173806,0.00198837585489433,0.00255513033042794,0.00326409581589132,0.00414530136103605,0.00523360816355579,0.00656911913554677,0.00819753592459614,0.0101704386687197,0.0125454614359466,0.0153863347839255,0.0187627664349378,0.0227501319481792,0.0274289497038368,0.0328841186591639,0.0392039032874827,0.0464786578637200,0.0547992916995580,0.0642554878189358,0.0749336995343271,0.0869149619470851,0.100272567954442,0.115069670221708,0.131356881042731,0.149169950330981,0.168527607466838,0.189429654776712,0.211855398583397,0.235762497779251,0.261086299692862,0.287739718849027,0.315613696516223,0.344578258389676,0.374484165276680,0.405165128302204,0.436440537108567,0.468118627986013,0.500000000000000,0.531881372013987,0.563559462891433,0.594834871697796,0.625515834723320,0.655421741610324,0.684386303483777,0.712260281150973,0.738913700307138,0.764237502220749,0.788144601416603,0.810570345223288,0.831472392533162,0.850830049669019,0.868643118957269,0.884930329778292,0.899727432045558,0.913085038052915,0.925066300465673,0.935744512181064,0.945200708300442,0.953521342136280,0.960796096712517,0.967115881340836,0.972571050296163,0.977249868051821,0.981237233565062,0.984613665216075,0.987454538564053,0.989829561331280,0.991802464075404,0.993430880864453,0.994766391836444,0.995854698638964,0.996735904184109,0.997444869669572,0.998011624145106,0.998461804788262,0.998817109256896,0.999095744800178,0.999312862062084,0.999480964566793,0.999610287637418,0.999709142906709,0.999784226600705,0.999840891409842,0.999883383023185,0.999915043321502,0.999938482844817,0.999955725515688,0.999968328758167];
p0 = p0(:);
n=-4:.08:4;
n = n(:);
x=ceil((z+4)/0.08);
x(x>100)=100;
x(x<1)=1;
x=real(x);
% x=(x>100)*100+(x<1)+(x>=1).*(x<=100).*x;
alpha=(z-n(x))/0.08;
p=((1-alpha).*p0(x)+alpha.*p0(x+1)).*(z<=4).*(z>-4)+p;